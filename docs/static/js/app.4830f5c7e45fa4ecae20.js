webpackJsonp([1],{"6vnE":function(e,t){},"7Otq":function(e,t,n){e.exports=n.p+"static/img/logo.f929b49.png"},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("7+uW"),a=n("NYxO");i.default.use(a.a);var s=new a.a.Store({state:{shape:{circleName:"圆形",triangleName:"三角形",rectangleName:"长方形",pentagonName:"五边形",hexagonName:"六边形",defaultName:"其他"},style:{circleColor:"#FFB50B",triangleColor:"#FC0006",rectangleColor:"#0E00FF",pentagonColor:"#139614",hexagonColor:"#9600FF",defaultColor:"#280091",lineWidth:2}},getters:{getCircleName:function(e){return e.shape.circleName},getTriangleName:function(e){return e.shape.triangleName},getRectangleName:function(e){return e.shape.rectangleName},getPentagonName:function(e){return e.shape.pentagonName},getHexagonName:function(e){return e.shape.hexagonName},getDefaultName:function(e){return e.shape.defaultName},getCircleColor:function(e){return e.style.circleColor},getTriangleColor:function(e){return e.style.triangleColor},getRectangleColor:function(e){return e.style.rectangleColor},getPentagonColor:function(e){return e.style.pentagonColor},getHexagonColor:function(e){return e.style.hexagonColor},getDefaultColor:function(e){return e.style.defaultColor},getLineWidth:function(e){return e.style.lineWidth}}});i.default.prototype.$store=s;var o=s,r={recognize:function(e){var t=e.lineNum,n={color:o.getters.getDefaultColor,tag:o.getters.getDefaultName};return 1===t?(n.color=o.getters.getCircleColor,n.tag=o.getters.getCircleName):3===t?(n.color=o.getters.getTriangleColor,n.tag=o.getters.getTriangleName):4===t?(n.color=o.getters.getRectangleColor,n.tag=o.getters.getRectangleName):5===t?(n.color=o.getters.getPentagonColor,n.tag=o.getters.getPentagonName):6===t&&(n.color=o.getters.getHexagonColor,n.tag=o.getters.getHexagonName),n},isValidJSON:function(e){try{if(!(e instanceof Array))return!1;if(0===e.length)return!0;var t=e[0];if(void 0===t.tag||void 0===t.lines)return!1;if(!(t.lines instanceof Array))return!1;if(0===t.lines.length)return!0;var n=t.lines[0];if(void 0===n.color||void 0===n.points)return!1;if(!(n.points instanceof Array))return!1;if(0===n.points.length)return!0;var i=n.points[0];return void 0!==i.percentX&&void 0!==i.percentY}catch(e){return!1}}},l={name:"function-pane",data:function(){return{dialogFormVisible:!1,fileName:""}},methods:{readFile:function(e){var t=this,n=e.target.files[0],i=new FileReader;i.onload=function(e){var n=JSON.parse(e.target.result);r.isValidJSON(n)?t.$bus.$emit("readFile",n):t.$message({message:"所选文件的数据不正确！",type:"warning"})},i.readAsText(n)},saveFile:function(){var e=this;""===this.fileName?this.$message({message:"输入的文件名不能为空！",type:"warning"}):(this.dialogFormVisible=!1,this.$bus.$emit("saveFile",function(t){var i=n("lDdF"),a=new File([t],e.fileName+".json",{type:"text/plain;charset=utf-8"});i.saveAs(a)}),this.$message({message:"文件保存成功！",type:"success"}))}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"header"},[i("img",{staticClass:"logo",attrs:{src:n("7Otq")}}),e._v(" "),i("div",{staticClass:"title"},[e._v("绘画板")]),e._v(" "),i("div",{staticClass:"load-button-container"},[i("label",{staticClass:"load-button",staticStyle:{display:"flex"}},[i("i",{staticClass:"el-icon-edit-outline"}),e._v(" "),i("input",{attrs:{type:"file",accept:".json"},on:{change:e.readFile}})]),e._v(" "),i("el-button",{staticClass:"load-button",attrs:{icon:"el-icon-download"},on:{click:function(t){e.dialogFormVisible=!0}}}),e._v(" "),i("el-dialog",{attrs:{title:"保存文件",visible:e.dialogFormVisible,width:"500px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{attrs:{"label-position":"left","label-width":"80px"}},[i("el-form-item",{attrs:{label:"文件名："}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入内容"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}},[i("template",{slot:"append"},[e._v(". JSON")])],2)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{round:""},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",round:""},on:{click:e.saveFile}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var u=n("VU/8")(l,c,!1,function(e){n("f+6j")},"data-v-a53d6132",null).exports,h=n("XaHv"),g={name:"color-board",components:{ColorPicker:n.n(h).a},data:function(){return{color:{hue:0,saturation:100,luminosity:50,alpha:1}}},mounted:function(){var e=this;this.$nextTick(function(){e.setColor()})},methods:{setColor:function(){var e="hsla("+this.color.hue+","+this.color.saturation+"%,"+this.color.luminosity+"%,"+this.color.alpha+")";this.$bus.emit("setColor",e)},enableDraw:function(){this.$bus.$emit("enableDraw")},recognizeFigure:function(){this.$bus.$emit("recognizeFigure")},undoOneLine:function(){this.$bus.$emit("undoOneLine")},clearCanvas:function(){this.$bus.$emit("clearCanvas")}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"aside"},[n("div",{staticClass:"color-board"},[n("color-picker",{staticClass:"radial-color-picker",on:{input:e.setColor},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}}),e._v(" "),n("el-form",{staticStyle:{margin:"10px"},attrs:{"label-position":"left","label-width":"60px"}},[n("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"饱和度"}},[n("el-slider",{on:{change:e.setColor},model:{value:e.color.saturation,callback:function(t){e.$set(e.color,"saturation",t)},expression:"color.saturation"}})],1),e._v(" "),n("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"亮度"}},[n("el-slider",{on:{change:e.setColor},model:{value:e.color.luminosity,callback:function(t){e.$set(e.color,"luminosity",t)},expression:"color.luminosity"}})],1)],1)],1),e._v(" "),n("el-form",{staticClass:"button-list"},[n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.enableDraw}},[e._v("开始绘画")])],1),e._v(" "),n("el-form-item",[n("el-popover",{attrs:{placement:"right",trigger:"hover"}},[n("div",{staticClass:"recognition-info"},[n("el-form",{attrs:{"label-width":"80px",labelPosition:"left"}},[n("el-form-item",{attrs:{label:this.$store.getters.getTriangleName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getTriangleColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getRectangleName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getRectangleColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getPentagonName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getPentagonColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getHexagonName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getHexagonColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getCircleName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getCircleColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getDefaultName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getDefaultColor}})])],1)],1),e._v(" "),n("el-button",{attrs:{slot:"reference",type:"success"},on:{click:e.recognizeFigure},slot:"reference"},[e._v("图形识别")])],1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"warning"},on:{click:e.undoOneLine}},[e._v("撤销一笔")])],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"danger"},on:{click:e.clearCanvas}},[e._v("清空画布")])],1)],1)],1)},staticRenderFns:[]};var d=n("VU/8")(g,f,!1,function(e){n("6vnE")},null,null).exports,v=n("mvHQ"),m=n.n(v),p=n("Zrlr"),C=n.n(p),b=n("wxAW"),w=n.n(b),y=n("GPkW"),$=function(){function e(t){C()(this,e),this.color="",this.points=[],void 0!==t&&(this.color=t.color,this.points=t.points)}return w()(e,[{key:"addPoint",value:function(e,t){var n={percentX:e,percentY:t};this.points.push(n)}},{key:"draw",value:function(e){var t=this;this.points.forEach(function(n,i){var a=n.percentX*e.width,s=n.percentY*e.height;0===i&&e.newStroke(),e.draw(a,s,t.color)})}},{key:"clone",value:function(){var t=new e;return t.color=this.color,t.points=this.points,t}},{key:"toJSON",value:function(){return{color:this.color,points:this.points}}}]),e}(),N=function(){function e(t){var n=this;C()(this,e),this.tag="",this.lines=[],void 0!==t&&(this.tag=t.tag,t.lines.forEach(function(e){n.lines.push(new $(e))}))}return w()(e,[{key:"addLine",value:function(e){this.lines.push(e)}},{key:"removeOneLine",value:function(){this.lines.pop()}},{key:"draw",value:function(e){if(this.lines.forEach(function(t){t.draw(e)}),""!==this.tag){var t=e.lastCoordinate,n="position:absolute; white-space: nowrap;top:"+t.y+"px;left:"+t.x+"px;";y.drawHTML('<span style="'+n+'">'+this.tag+"</span>",e.element)}}},{key:"clone",value:function(){var t=new e;return t.tag=this.tag,t.lines=this.lines,t}},{key:"toJSON",value:function(){var e={tag:this.tag,lines:[]};return this.lines.forEach(function(t){e.lines.push(t.toJSON())}),e}},{key:"color",set:function(e){this.lines.forEach(function(t){t.color=e})}},{key:"lineNum",get:function(){return this.lines.length}}]),e}(),x=function(){function e(t){C()(this,e),this.element=null,this.context=null,this.lastCoordinate={x:0,y:0},this.haveDrawn=!1,this.element=t,this.context=t.getContext("2d")}return w()(e,[{key:"setSize",value:function(e,t){this.element.width=e,this.element.height=t}},{key:"setEvent",value:function(e,t){this.element.addEventListener(e,t)}},{key:"newStroke",value:function(){this.haveDrawn=!1}},{key:"clear",value:function(){var e=this.element.width,t=this.element.height;this.context.clearRect(0,0,e,t)}},{key:"draw",value:function(e,t,n){this.haveDrawn||(this.lastCoordinate={x:e,y:t},this.haveDrawn=!0),this.context.beginPath(),this.context.lineWidth=o.getters.getLineWidth,this.context.lineCap="round",this.context.strokeStyle=n,this.context.moveTo(e,t),this.context.lineTo(this.lastCoordinate.x,this.lastCoordinate.y),this.context.stroke(),this.context.closePath(),this.lastCoordinate={x:e,y:t}}},{key:"width",get:function(){return this.element.width}},{key:"height",get:function(){return this.element.height}}]),e}(),k={name:"canvas-pane",data:function(){return{color:"hsla(0,100,50,1)",ratio:9/16,isDrawing:!1,drawingEnabled:!1,canvas:null,canvasContext:null,paintingData:null,figure:null,line:null}},mounted:function(){var e=this;this.$bus.$on("setColor",function(t){e.color=t}),this.$bus.$on("enableDraw",function(){e.enableDraw()}),this.$bus.$on("recognizeFigure",function(){e.recognizeFigure()}),this.$bus.$on("undoOneLine",function(){e.figure.removeOneLine(),e.repaint()}),this.$bus.$on("clearCanvas",function(){e.canvas.clear(),e.clearSavedData()}),this.$bus.$on("readFile",function(t){e.clearSavedData(),t.forEach(function(t){e.paintingData.push(new N(t))}),e.repaint()}),this.$bus.$on("saveFile",function(t){var n=[];e.paintingData.forEach(function(e){n.push(e.toJSON())}),0!==e.figure.lineNum&&n.push(e.figure.toJSON()),t(m()(n))}),this.$nextTick(function(){e.canvas=new x(document.getElementById("canvas")),e.canvas.setEvent("mousedown",e.startDrawing),e.canvas.setEvent("mouseup",e.endDrawing),e.canvas.setEvent("mouseout",e.endDrawing),e.canvas.setEvent("mousemove",e.moveBrush),e.clearSavedData(),e.resetCanvas(),window.addEventListener("resize",e.resetCanvas)})},methods:{clearSavedData:function(){this.paintingData=[],this.figure=new N,this.line=new $,this.drawingEnabled=!1,this.isDrawing=!1},startDrawing:function(e){if(this.drawingEnabled){this.isDrawing=!0;var t=e.offsetX,n=e.offsetY;this.canvas.newStroke(),this.canvas.draw(t,n,this.color),this.line=new $,this.line.color=this.color,this.line.addPoint(t/this.canvas.width,n/this.canvas.height)}},endDrawing:function(){this.isDrawing&&(this.figure.addLine(this.line.clone()),this.isDrawing=!1)},moveBrush:function(e){if(this.isDrawing){var t=e.offsetX,n=e.offsetY;this.canvas.draw(t,n,this.color),this.line.addPoint(t/this.canvas.width,n/this.canvas.height)}},resetCanvas:function(){var e=document.getElementById("canvas").offsetWidth;this.canvas.setSize(e,e*this.ratio),this.repaint()},repaint:function(){var e=this;this.canvas.clear(),this.paintingData.forEach(function(t){t.draw(e.canvas)}),this.figure.draw(this.canvas)},enableDraw:function(){!1===this.drawingEnabled?this.drawingEnabled=!0:0!==this.figure.lineNum&&this.$message({message:"请先对已绘画的图形进行标记！",type:"warning"})},recognizeFigure:function(){if(this.drawingEnabled&&this.figure.lineNum>0){var e=r.recognize(this.figure);this.figure.color=e.color,this.figure.tag=e.tag,this.repaint(),this.$message({message:"识别结果："+this.figure.tag,type:"success"});var t=this.figure.clone();this.paintingData.push(t),this.figure=new N,this.line=new $,this.drawingEnabled=!1}else this.$message({message:"未进行绘制！请开始绘制！",type:"warning"})}}},_={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"canvas-container"},[t("div",{staticClass:"paint-area"},[t("canvas",{attrs:{id:"canvas"}})])])}]};var D={name:"App",components:{CanvasPane:n("VU/8")(k,_,!1,function(e){n("bVev")},"data-v-f29b015e",null).exports,AsidePane:d,HeaderPane:u}},F={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",{staticClass:"whole-page"},[t("el-header",[t("header-pane")],1),this._v(" "),t("el-container",[t("el-aside",[t("aside-pane")],1),this._v(" "),t("el-main",[t("canvas-pane")],1)],1)],1)},staticRenderFns:[]};var E=n("VU/8")(D,F,!1,function(e){n("dTse")},null,null).exports,S=n("/ocq");i.default.use(S.a);var O=new S.a({routes:[]}),P=n("zL8q"),L=n.n(P),R=(n("tvR6"),n("fC7K"));i.default.use(L.a),i.default.use(R.a),i.default.use(a.a),new i.default({el:"#app",router:O,store:o,components:{App:E},template:"<App/>",render:function(e){return e(E)}})},bVev:function(e,t){},dTse:function(e,t){},"f+6j":function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.4830f5c7e45fa4ecae20.js.map