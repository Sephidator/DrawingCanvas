webpackJsonp([1],{"7Otq":function(e,t,n){e.exports=n.p+"static/img/logo.f929b49.png"},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),i={name:"function-pane",data:function(){return{dialogFormVisible:!1,fileName:""}},methods:{readFile:function(e){var t=this,n=e.target.files[0],a=new FileReader;a.onload=function(e){var n=JSON.parse(e.target.result);t.$bus.$emit("readFile",n)},a.readAsText(n)},saveFile:function(){if(""===this.fileName)this.$message({message:"输入的文件名不能为空！",type:"warning"});else{this.dialogFormVisible=!1;var e="";this.$bus.$emit("saveFile",function(t){e=t});var t=n("lDdF"),a=new File([e],this.fileName+".json",{type:"text/plain;charset=utf-8"});t.saveAs(a),this.$message({message:"文件保存成功！",type:"success"})}}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("img",{staticClass:"logo",attrs:{src:n("7Otq")}}),e._v(" "),a("div",{staticClass:"title"},[e._v("绘画板")]),e._v(" "),a("div",{staticClass:"load-button-container"},[a("label",{staticClass:"load-button",staticStyle:{display:"flex"}},[a("i",{staticClass:"el-icon-edit-outline"}),e._v(" "),a("input",{attrs:{type:"file"},on:{change:e.readFile}})]),e._v(" "),a("el-button",{staticClass:"load-button",attrs:{icon:"el-icon-download"},on:{click:function(t){e.dialogFormVisible=!0}}}),e._v(" "),a("el-dialog",{attrs:{title:"保存文件",visible:e.dialogFormVisible,width:"500px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{"label-position":"left","label-width":"80px"}},[a("el-form-item",{attrs:{label:"文件名："}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入内容"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}},[a("template",{slot:"append"},[e._v(". JSON")])],2)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{round:""},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:""},on:{click:e.saveFile}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var o=n("VU/8")(i,s,!1,function(e){n("QSdF")},"data-v-d03e50c2",null).exports,r=n("XaHv"),l={name:"color-board",components:{ColorPicker:n.n(r).a},data:function(){return{color:{hue:0,saturation:100,luminosity:50,alpha:1}}},mounted:function(){var e=this;this.$nextTick(function(){e.setColor()})},methods:{setColor:function(){var e="hsla("+this.color.hue+","+this.color.saturation+"%,"+this.color.luminosity+"%,"+this.color.alpha+")";this.$bus.emit("setColor",e)},enableDraw:function(){this.$bus.$emit("enableDraw")},recognizeFigure:function(){this.$bus.$emit("recognizeFigure")},undoOneLine:function(){this.$bus.$emit("undoOneLine")},clearCanvas:function(){this.$bus.$emit("clearCanvas")}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"aside"},[n("div",{staticClass:"color-board"},[n("color-picker",{staticClass:"radial-color-picker",on:{input:e.setColor},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}}),e._v(" "),n("el-form",{staticStyle:{margin:"10px"},attrs:{"label-position":"left","label-width":"60px"}},[n("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"饱和度"}},[n("el-slider",{on:{change:e.setColor},model:{value:e.color.saturation,callback:function(t){e.$set(e.color,"saturation",t)},expression:"color.saturation"}})],1),e._v(" "),n("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"亮度"}},[n("el-slider",{on:{change:e.setColor},model:{value:e.color.luminosity,callback:function(t){e.$set(e.color,"luminosity",t)},expression:"color.luminosity"}})],1)],1)],1),e._v(" "),n("el-form",{staticClass:"button-list"},[n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.enableDraw}},[e._v("开始绘画")])],1),e._v(" "),n("el-form-item",[n("el-popover",{attrs:{placement:"right",trigger:"hover"}},[n("div",{staticClass:"recognition-info"},[n("el-form",{attrs:{"label-width":"80px",labelPosition:"left"}},[n("el-form-item",{attrs:{label:this.$store.getters.getTriangleName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getTriangleColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getRectangleName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getRectangleColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getPentagonName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getPentagonColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getHexagonName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getHexagonColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getCircleName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getCircleColor}})]),e._v(" "),n("el-form-item",{attrs:{label:this.$store.getters.getDefaultName}},[n("div",{staticClass:"littleCircle",style:{backgroundColor:this.$store.getters.getDefaultColor}})])],1)],1),e._v(" "),n("el-button",{attrs:{slot:"reference",type:"success"},on:{click:e.recognizeFigure},slot:"reference"},[e._v("图形识别")])],1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"warning"},on:{click:e.undoOneLine}},[e._v("撤销一笔")])],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"danger"},on:{click:e.clearCanvas}},[e._v("清空画布")])],1)],1)],1)},staticRenderFns:[]};var u=n("VU/8")(l,c,!1,function(e){n("PMVJ")},null,null).exports,g=n("mvHQ"),d=n.n(g),f=n("GPkW"),h={name:"canvas-pane",data:function(){return{color:"hsla(0,100,50,1)",ratio:9/16,lineWidth:2,canvas:null,canvasContext:null,isDrawing:!1,drawingEnabled:!1,oldPoint:{x:0,y:0},paintingData:[this.figure],figure:{tag:"",lines:[this.line]},line:{color:"",points:[{percentX:0,percentY:0}]}}},mounted:function(){var e=this;this.$bus.$on("setColor",function(t){e.color=t}),this.$bus.$on("enableDraw",function(){!1===e.drawingEnabled?e.drawingEnabled=!0:e.$message({message:"请先对已绘画的图形进行标记！",type:"warning"})}),this.$bus.$on("recognizeFigure",function(){if(e.drawingEnabled&&e.figure.lines.length>0){1===e.figure.lines.length?e.setFigureColorAndTag(e.figure,e.$store.getters.getCircleColor,e.$store.getters.getCircleName):3===e.figure.lines.length?e.setFigureColorAndTag(e.figure,e.$store.getters.getTriangleColor,e.$store.getters.getTriangleName):4===e.figure.lines.length?e.setFigureColorAndTag(e.figure,e.$store.getters.getRectangleColor,e.$store.getters.getRectangleName):5===e.figure.lines.length?e.setFigureColorAndTag(e.figure,e.$store.getters.getPentagonColor,e.$store.getters.getPentagonName):6===e.figure.lines.length?e.setFigureColorAndTag(e.figure,e.$store.getters.getHexagonColor,e.$store.getters.getHexagonName):e.setFigureColorAndTag(e.figure,e.$store.getters.getDefaultColor,e.$store.getters.getDefaultName),e.$message({message:"识别结果："+e.figure.tag,type:"success"});var t=JSON.parse(d()(e.figure));e.paintingData.push(t),e.figure.tag="",e.figure.lines=[],e.line.color="",e.line.points=[],e.drawingEnabled=!1}else e.$message({message:"未进行绘制！请开始绘制！",type:"warning"})}),this.$bus.$on("undoOneLine",function(){e.figure.lines.pop(),e.figure.tag="",e.repaint()}),this.$bus.$on("clearCanvas",function(){e.canvasContext.clearRect(0,0,e.canvas.width,e.canvas.height),e.clearSavedData()}),this.$bus.$on("readFile",function(t){e.clearSavedData(),e.paintingData=t,e.repaint()}),this.$bus.$on("saveFile",function(t){var n=JSON.parse(d()(e.paintingData)),a=JSON.parse(d()(e.figure));n.push(a),t(d()(n))}),this.$nextTick(function(){e.canvas=document.getElementById("canvas"),e.canvasContext=e.canvas.getContext("2d"),e.canvas.addEventListener("mousedown",e.startDrawing),e.canvas.addEventListener("mouseup",e.endDrawing),e.canvas.addEventListener("mouseout",e.endDrawing),e.canvas.addEventListener("mousemove",e.moveBrush),e.clearSavedData(),e.resetCanvas(),window.addEventListener("resize",e.resetCanvas)})},methods:{clearSavedData:function(){this.paintingData=[],this.figure.tag="",this.figure.lines=[],this.line.color="",this.line.points=[],this.drawingEnabled=!1,this.isDrawing=!1},startDrawing:function(e){if(this.drawingEnabled){this.isDrawing=!0;var t=e.offsetX,n=e.offsetY;this.oldPoint={x:t,y:n},this.draw(t,n,this.color),this.line.color=this.color,this.line.points.length=0,this.line.points.push({percentX:t/this.canvas.width,percentY:n/this.canvas.height})}},endDrawing:function(){if(this.isDrawing){var e=JSON.parse(d()(this.line));this.figure.lines.push(e),this.isDrawing=!1}},moveBrush:function(e){if(this.isDrawing){var t=e.offsetX,n=e.offsetY;this.draw(t,n,this.color),this.oldPoint={x:t,y:n},this.line.points.push({percentX:t/this.canvas.width,percentY:n/this.canvas.height})}},draw:function(e,t,n){this.canvasContext.beginPath(),this.canvasContext.lineWidth=this.lineWidth,this.canvasContext.lineCap="round",this.canvasContext.strokeStyle=n,this.canvasContext.moveTo(e,t),this.canvasContext.lineTo(this.oldPoint.x,this.oldPoint.y),this.canvasContext.stroke(),this.canvasContext.closePath()},resetCanvas:function(){var e=document.getElementById("canvas").offsetWidth;this.canvas.width=e,this.canvas.height=e*this.ratio,this.repaint()},repaint:function(){var e=this;this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.paintingData.forEach(function(t){e.drawOneFigure(t)}),this.drawOneFigure(this.figure)},drawOneFigure:function(e){var t=this;if(e.lines.forEach(function(e){var n=e.color;e.points.forEach(function(e,a){var i=e.percentX*t.canvas.width,s=e.percentY*t.canvas.height;0===a&&(t.oldPoint={x:i,y:s}),t.draw(i,s,n),t.oldPoint={x:i,y:s}})}),""!==e.tag){var n="position:absolute; white-space: nowrap;top:"+this.oldPoint.y+"px;left:"+this.oldPoint.x+"px;";f.drawHTML('<span style="'+n+'">'+e.tag+"</span>",this.canvas)}},setFigureColorAndTag:function(e,t,n){e.tag=n,e.lines.forEach(function(e){e.color=t}),this.repaint()}}},v={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"canvas-container"},[t("div",{staticClass:"paint-area"},[t("canvas",{attrs:{id:"canvas"}})])])}]};var m={name:"App",components:{CanvasPane:n("VU/8")(h,v,!1,function(e){n("uGJu")},"data-v-22f6899c",null).exports,AsidePane:u,HeaderPane:o}},p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",{staticClass:"whole-page"},[t("el-header",[t("header-pane")],1),this._v(" "),t("el-container",[t("el-aside",[t("aside-pane")],1),this._v(" "),t("el-main",[t("canvas-pane")],1)],1)],1)},staticRenderFns:[]};var C=n("VU/8")(m,p,!1,function(e){n("bSqK")},null,null).exports,b=n("/ocq");a.default.use(b.a);var $=new b.a({routes:[]}),w=n("zL8q"),x=n.n(w),N=(n("tvR6"),n("fC7K")),y=n("NYxO");a.default.use(y.a);var F=new y.a.Store({state:{circleName:"圆形",triangleName:"三角形",rectangleName:"长方形",pentagonName:"五边形",hexagonName:"六边形",defaultName:"其他",circleColor:"#FFB50B",triangleColor:"#FC0006",rectangleColor:"#0E00FF",pentagonColor:"#139614",hexagonColor:"#9600FF",defaultColor:"#280091"},getters:{getCircleName:function(e){return e.circleName},getTriangleName:function(e){return e.triangleName},getRectangleName:function(e){return e.rectangleName},getPentagonName:function(e){return e.pentagonName},getHexagonName:function(e){return e.hexagonName},getDefaultName:function(e){return e.defaultName},getCircleColor:function(e){return e.circleColor},getTriangleColor:function(e){return e.triangleColor},getRectangleColor:function(e){return e.rectangleColor},getPentagonColor:function(e){return e.pentagonColor},getHexagonColor:function(e){return e.hexagonColor},getDefaultColor:function(e){return e.defaultColor}}});a.default.prototype.$store=F;var _=F;a.default.use(x.a),a.default.use(N.a),a.default.use(y.a),new a.default({el:"#app",router:$,store:_,components:{App:C},template:"<App/>",render:function(e){return e(C)}})},PMVJ:function(e,t){},QSdF:function(e,t){},bSqK:function(e,t){},tvR6:function(e,t){},uGJu:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.70a1e79339125a634fa3.js.map